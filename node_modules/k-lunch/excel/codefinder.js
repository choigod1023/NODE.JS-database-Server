const fs = require('fs')
const xlsx = require('xlsx');

const workbook = xlsx.readFile(`${__dirname}/codeList.xls`)
const sheetName = workbook.SheetNames[0]
const worksheet = workbook.Sheets[sheetName]
const data = xlsx.utils.sheet_to_json(worksheet, {header:1})

const getDomainCode = (domain) => {
  let ret = null
  switch(domain) {
    case '서울특별시':
      ret = 'sen'
      break
    case '부산광역시':
      ret = 'pen'
      break
    case '대구광역시':
      ret = 'dge'
      break
    case '인천광역시':
      ret = 'ice'
      break
    case '광주광역시':
      ret = 'gen'
      break
    case '대전광역시':
      ret = 'dge'
      break
    case '울산광역시':
      ret = 'use'
      break
    case '세종특별자치시':
      ret = 'sje'
      break
    case '경기도':
      ret = 'goe'
      break
    case '강원도':
      ret = 'kwe'
      break
    case '충청북도':
      ret = 'cbe'
      break
    case '충청남도':
      ret = 'cne'
      break
    case '전라북도':
      ret = 'jbe'
      break
    case '전라남도':
      ret = 'jne'
      break
    case '경상북도':
      ret = 'gbe'
      break
    case '경상남도':
      ret = 'gne'
      break
    case '제주특별자치도':
      ret = 'jje'
      break
  }
  return ret
}

const getRow = (schoolName, n) => {
  let ret = false
  data.forEach(row => {
    if(row[2] === schoolName) {
      ret = row[n]
    }
  })

  return ret
}

module.exports.getCode = schoolName => {
  return getRow(schoolName, 0)
}

module.exports.getDomain = schoolName => {
  const domain = getRow(schoolName, 1)
  return getDomainCode(domain)
}
